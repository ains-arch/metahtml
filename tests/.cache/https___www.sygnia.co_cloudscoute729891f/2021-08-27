<!DOCTYPE html><!-- Last Published: Sun Aug 15 2021 16:23:25 GMT+0000 (Coordinated Universal Time) --><html data-wf-domain="www.sygnia.co" data-wf-page="5ff707f7852533ba913a677c" data-wf-site="594bb4be5d975d31da8bea55"><head><meta charset="utf-8"/><title>Cloud Scout: A New Open Source Tool for Cloud Security</title><meta content="Sygnia is releasing Cloud Scout, an open source tool for cloud security. Cloud Scout was built to map cloud and hybrid cloud environments, identify and visualize cross platform attack paths, vulnerabilities, and enhance overall resilience." name="description"/><meta content="Cloud Scout: A New Open Source Tool for Cloud Security" property="og:title"/><meta content="Sygnia is releasing Cloud Scout, an open source tool for cloud security. Cloud Scout was built to map cloud and hybrid cloud environments, identify and visualize cross platform attack paths, vulnerabilities, and enhance overall resilience." property="og:description"/><meta content="Cloud Scout: A New Open Source Tool for Cloud Security" property="twitter:title"/><meta content="Sygnia is releasing Cloud Scout, an open source tool for cloud security. Cloud Scout was built to map cloud and hybrid cloud environments, identify and visualize cross platform attack paths, vulnerabilities, and enhance overall resilience." property="twitter:description"/><meta property="og:type" content="website"/><meta content="summary_large_image" name="twitter:card"/><meta content="width=device-width, initial-scale=1" name="viewport"/><link href="https://uploads-ssl.webflow.com/594bb4be5d975d31da8bea55/css/sygnia-e975021595808aba032b80702432121f.webflow.2d6db7121.min.css" rel="stylesheet" type="text/css"/><script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.26/webfont.js" type="text/javascript"></script><script type="text/javascript">WebFont.load({  google: {    families: ["Maven Pro:regular,500,600,700,800,900","Monda:regular,700"]  }});</script><!--[if lt IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" type="text/javascript"></script><![endif]--><script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script><link href="https://uploads-ssl.webflow.com/594bb4be5d975d31da8bea55/594bb4be5d975d31da8beb15_favi.jpg" rel="shortcut icon" type="image/x-icon"/><link href="https://uploads-ssl.webflow.com/594bb4be5d975d31da8bea55/594bb4be5d975d31da8beb14_favil.jpg" rel="apple-touch-icon"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-9BH3DXVK4Q"></script><script type="text/javascript">window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('config', 'G-9BH3DXVK4Q', {'anonymize_ip': false});</script><script src="https://www.google.com/recaptcha/api.js" type="text/javascript"></script><style>
.body {overflow-x: hidden;}
 body { -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; } 


</style>

</head><body class="body"><div data-collapse="none" data-animation="default" data-duration="400" role="banner" class="navbar-main vertical w-nav"><div class="navbar-rd-container"><div class="menu-holder"><a href="/" class="brand w-nav-brand"><img src="https://uploads-ssl.webflow.com/594bb4be5d975d31da8bea55/5fce69d9338e1a4922628168_Logo.svg" loading="lazy" alt="" class="sygnia-logo"/></a><nav role="navigation" data-w-id="89fbc7ea-873f-0d6e-f83e-ee5fd9d11b22" class="navbar-menu mm w-nav-menu"><div class="nav-menu-wrapper"><div class="nav-menu-devider"></div><a href="/proactive-defense" class="nav-link-rd w-inline-block"><div>PROACTIVE DEFENSE</div></a><a href="/offensive-security" class="nav-link-rd w-inline-block"><div>Adversarial security</div></a><a href="/threat-response" class="nav-link-rd w-inline-block"><div>THREAT RESPONSE</div></a><div class="nav-link-rd ser hidden"><div class="latest-text">Services</div><div class="ser-dropdown"><div class="navbar-rd-container dd"><div class="drop-down"><div class="drop-down-row"><a href="/proactive-defense" class="nav-link-rd-ser drop w-inline-block"><div>PROACTIVE DEFENSE</div></a></div><div class="dropdown-devider"></div><div class="drop-down-row"><a href="/threat-response" class="nav-link-rd-ser drop w-inline-block"><div>THREAT RESPONSE</div></a></div><div class="dropdown-devider"></div><div class="drop-down-row"><a href="/offensive-security" class="nav-link-rd-ser drop w-inline-block"><div>OFFENSIVE SECURITY</div></a></div></div></div></div></div><div class="nav-menu-devider"></div><div class="nav-link-rd lre"><div class="latest-text">resources</div><div class="lre-dropdown"><div class="navbar-rd-container dd"><div class="drop-down vertical"><a href="/mata-framework" class="drop-down-row vertical w-inline-block"><div class="text-block-12">Lazarus Groupâs MATA Framework Leveraged to Deploy TFlower Ransomware</div></a><a href="/golden-saml-advisory" class="drop-down-row vertical w-inline-block"><div class="text-block-12">Detection and Hunting of Golden SAML Attack</div></a><a href="/cloudscout" aria-current="page" class="drop-down-row vertical w-inline-block w--current"><div class="text-block-12">Cloud Scout: A New Open Source Tool for Cloud Security</div></a><a href="/kaseya-ransomware-advisory" class="drop-down-row vertical w-inline-block"><div class="text-block-12">Kaseya Ransomware Advisory</div></a><a href="/demystifying-the-printnightmare-vulnerability" class="drop-down-row vertical w-inline-block"><div class="text-block-12">Demystifying the PrintNightmare Vulnerability</div></a><a href="/praying-mantis-targeted-apt" class="drop-down-row vertical w-inline-block"><div class="text-block-12">TG1021: Praying Mantis APT</div></a></div></div></div></div><div class="nav-menu-devider"></div><a href="/about" class="nav-link-rd w-inline-block"><div>About</div></a><a href="/contact-us" class="nav-link-rd w-inline-block"><div>CONTACT US</div></a></div></nav></div><div data-w-id="89fbc7ea-873f-0d6e-f83e-ee5fd9d11b62" class="close-mobile-nav"></div><div class="nav-menu-button"><div data-w-id="89fbc7ea-873f-0d6e-f83e-ee5fd9d11b64" class="nav-menu-button"><div class="line-1 simple"></div><div class="line-2 simple"></div><div class="line-3 simple"></div></div></div></div></div><div class="section-2 wf-section"><div class="container-5 w-container"><h1 class="h1 hpph ap">Cloud Scout: A New Open Source Tool for Cloud Security</h1><img src="https://uploads-ssl.webflow.com/594bb4be5d975d31da8bea55/5f8ebfe825df89e97bfd8522_sygnia%20lgo%201%20(1)%20(1).png" loading="lazy" alt="" class="image-10"/><p class="p ap">Sygnia deploys top talent and implements the operational art of elite military units, digital combat experience, and a deep understanding of attackers to secure organizations.</p><p class="p ap-author">October 23, 2020</p><div class="rich-text-block-2 w-richtext"><h4>Overview</h4><p>Sygnia is releasing Cloud Scout, an open source tool for cloud security. Cloud Scout was built to map cloud and hybrid cloud environments, identify and visualize cross platform attack paths, vulnerabilities, and enhance overall resilience. </p><p>Cloud Scout is doing this by leveraging and bringing together the capabilities of great open source tools that are available today, such as BloodHound, StormSpotter and AWSPX; and by adding new functionality and capabilities. You can download the tool <a href="https://github.com/SygniaLabs/security-cloud-scout">here</a>.</p><h4>The Challenge</h4><p>The accelerated transition to cloud services and the adoption of hybrid cloud architectures is creating opportunities but is also introducing new and complex challenges to security. Â </p><p>Among the leading trajectories in cloud which require security attention are:</p><ul role="list"><li>Multi cloud/Cross cloud connectivity â many companies utilize multiple cloud vendors and have many connections established between their applications and services</li><li>Infrastructure as a Code (IaC) â while in the past CI/CD pipelines were a separate technical procedure, now this area is brought into the cloud and allows building, testing and deploying the code in a single place</li><li>Native cloud services â new native cloud services and micro services replace other traditional IT and introduce new security challenges that can be exploited with relative ease</li></ul><p>Threat actors are adapting to these changes, trying to take advantage of the opportunities created by the cloud. Â We are seeing an increasing focus on IaaS weaponization, cloud services targeting, and the development of tailor-made malware for cloud workloads.</p><p>While adopting hybrid environments, we are unintentionally âadoptingâ their new misconfigurations, gaps and vulnerabilities, which in turn may expose our entire infrastructure to security risks that could lead to full organizational compromise.</p><p>Security teams need to adapt the security of their cloud services to threats to stay ahead of the curve in the competition with threat actors. However, identifying gaps and misconfigurations manually is complex, and, in many cases, not feasible. The community provides a few great open source tools designed to support these efforts. Among these are Â BloodHound (by Specter Ops), StormSpotter (Microsoft) and AWSPX (F-Secure LABS). </p><p>Each of these tools provides data collection and analysis for a single âtypeâ of environment, be it Azure, AWS or on premises domain. Moreover, each framework is executed separately under separate databases, and is making their use not feasible for identifying cross platform, cloud or on-prem connection paths and vulnerabilities. Â Consolidation needs to be done manually and is inefficient. </p><p>In working with organizations worldwide, our teams have identified a need for a capability which will allow them full and efficient mapping and visualization of hybrid environments and attack surfaces. It is a critical foundation in the process of addressing vulnerabilities and adapting security to threats. Â </p><p>When we could not find a solution to meet this objective, we decided to develop our own, which we are now making available to the community. Inspired by âBlood Hound,â we named this tool âCloud Scout.â</p><h4>Solution</h4><p>Cloud Scout delivers three major unique capabilities:</p><ul role="list"><li>Connects cross platforms entities such as: Users, Applications, Roles and services, based on their corresponding attributes</li><li>Identifies cross platform attack paths that allow attackers to move laterally and escalate privileges </li><li>Visualizes the cross-platform attack paths on a single screen</li></ul><p>The tools that we mentioned earlier are all based on a neo4j graph database, and therefore we decided to expand those toolsâ functionality by merging them into one database, just as with real life hybrid environments, where all organizational infrastructures are interconnected.</p><p>For example: Users in the on-prem (Active Directory) AD are synced with users in (Azure Active Directory) AAD and, therefore, we can create a relation between StormSpotter users and BloodHound users, based on user security identifiers.</p><p>Beyond the trivial relations, we enriched the data of different nodes, and created more complex relations that will show us complex, nontrivial attack paths which we could not see in the past.</p><h4>Example Use-Cases</h4><p>In this section we will explain in depth a few of the use cases that Cloud Scout can help address, which have not been easily available before without a solution to interconnect multiple cloud providers under a single platform.</p><h4>Attacker path from on-premise to KeyVault</h4><p>The Azure KeyVault resource can be very valuable for an attacker, as it stores sensitive data which can provide an attacker with access to valuable assets. The illustration below (figure 1) demonstrates the added functionality visualized in an attack path to controlling Azure KeyVault that we otherwise would not have seen.</p><p>The attack path visualizes how an attacker can gain access to the specified KeyVault instance from the on-premises environment, combining two different frameworks.</p><p>In order to connect the different frameworks, relations between their nodes need to be created. In this case, Cloud Scout created relations between the on-premise user to the AAD user, with the same security identifier.</p><figure style="max-width:" class="w-richtext-align-center w-richtext-figure-type-image"><div><img src="https://uploads-ssl.webflow.com/594bb4be5d975d31da8bea55/5f918f7ef4a4ffc7c396ba77_Picture11.png" loading="lazy" alt=""/></div><figcaption>Figure 1 â Attacker path from on-premise to KeyVault</figcaption></figure><h4>Attacker path from Azure to on-premise</h4><p>Cloud Scout highlighted a path that begins in the on-premises environment and leverages Azure in order to take over that same on-premise domain, again, by visualizing a relationship that we would not have seen otherwise. The illustration below (Figure 2) demonstrates the path.</p><p>The attack path visualizes which users in the on-premise domain environment can leverage their roles both in on-premise and Azure environments, in order to gain privileges of âDomain Adminsâ group and gain control over the domain. </p><p>The relations identified by Cloud Scout in this scenario are as follows:</p><ul role="list"><li>Between on premise user and AAD user</li><li>Between âgroups administratorâ role and Azure groups</li><li>Between âapplication administratorâ role and Azure SP</li><li>Between VM instance on azure and the corresponding on-premise server</li></ul><figure class="w-richtext-align-center w-richtext-figure-type-image"><div><img src="https://uploads-ssl.webflow.com/594bb4be5d975d31da8bea55/5f918fd8e968b8482cc03a5b_Picture12.png" loading="lazy" alt=""/></div><figcaption>Figure 2 â Attacker path from Azure to on-premise</figcaption></figure><h4>Attacker path from on-premise to Azure and AWS</h4><p>The node on the right side of the illustration below (Figure 3) is the âEffective Adminâ role, which grants full control over an AWS account. An attacker may be interested in that role to gain access to critical business assets hosted on the AWS cloud provider.</p><p>The attack path visualizes which users in the on-premise domain environment can leverage their roles in order to gain the privileges of the âEffective Adminâ in AWS. In this instance we have visualized an attack path through three different environments, and relations that we would not have seen without the functionality of Cloud Scout.</p><p>The relations identified by Cloud Scout in this scenario are as follows:</p><ul role="list"><li>Between BloodHound user node and StormSpotter user node connected by the on-premise SID.</li><li>Between the âApplication Adminsitratorâ and the SP</li><li>Between the SP of azure and the corresponding role it has in the AWS environment</li></ul><figure class="w-richtext-align-center w-richtext-figure-type-image"><div><img src="https://uploads-ssl.webflow.com/594bb4be5d975d31da8bea55/5f919039a95769700ff2e840_Picture13.png" loading="lazy" alt=""/></div><figcaption>Figure 3 â Attacker path from on-premise to Azure and AWS</figcaption></figure><h4>Network data mapping</h4><p>Cloud Scout has the functionality to map network rules and show them in a visualized manner. Â At this point, we are not familiar with other open source tools that can provide this functionality, and we hope it will become increasingly available.</p><p>The path below illustrates which network rules are attached to which VMs, as well as the path connecting the rule to the VM hosted on Azure.</p><p>Relations identified by Cloud Scout: Between the IP to the corresponding NSG</p><figure class="w-richtext-align-center w-richtext-figure-type-image"><div><img src="https://uploads-ssl.webflow.com/594bb4be5d975d31da8bea55/5f9190797eae5153d7fb01d2_Picture14.png" loading="lazy" alt=""/></div><figcaption>Figure 4 - Network Data Mapping</figcaption></figure><h4>Architecture</h4><p>Cloud Scout is a plugin which works on top of BloodHound and, in order to actualize its full capabilities, depends on several open source frameworks, such as BloodHound, StormSpotter and AWSPX.</p><p>The Cloud Scout plugin extends BloodHound functionality, by adding a few additional buttons and visual elements to handle the ingestion of different frameworks and execute the logic to create relations between relevant nodes. To fully understand the architecture, we need to be familiar with BloodHound architecture. </p><p>Bloodhound consists of three main parts:</p><ul role="list"><li>GUI â the graphical interface, which is used by users</li><li>Neo4j â a database that stores the information ingested</li><li>Graph theory - the logic behind the graphs, that creates relations between entities</li></ul><p>The data showed in BloodHound is generated and collected by Sharphound ingestor from on-premise domain information.</p><p>Cloud Scout will have the same three capabilities</p><ul role="list"><li>GUI - handles the added the visualization layer: buttons, icons, text. </li><li>Database - uses one database for all frameworks (BloodHound, AWSPX, StormSpotter), and utilizes each framework ingestion process into the same database.</li><li>Graph theory - Behind the graphsâ logic to create complex relations.</li></ul><h4>Future</h4><p>We hope to continue to improve Cloud Scout and add new functionalities and features. What we currently plan includes: </p><ul role="list"><li>Support SSH private key processing to identify with corresponding VMs deployed on cloud environments</li><li>Create a tool for GCP environments enumeration</li><li>Improve integration with platforms</li><li>Create new relations based on new researches</li></ul><p>We hope you will be able to leverage the tool in enhancing resilience and we would appreciate any comment or ideas.</p><figure style="padding-bottom:33.75%" class="w-richtext-align-normal w-richtext-figure-type-video"><div><iframe allowfullscreen="true" frameborder="0" scrolling="no" src="//cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Ffast.wistia.net%2Fembed%2Fiframe%2Fn4izm09abp&amp;display_name=Wistia%2C+Inc.&amp;url=https%3A%2F%2Fnadavse.wistia.com%2Fmedias%2Fn4izm09abp&amp;image=https%3A%2F%2Fembed-ssl.wistia.com%2Fdeliveries%2F3122f50e414476e23b1c263fe98936cfec0804ef.jpg%3Fimage_crop_resized%3D960x540&amp;key=96f1f04c5f4143bcb0f2e68c87d65feb&amp;type=text%2Fhtml&amp;schema=wistia"></iframe></div></figure><h4>References</h4><ul role="list"><li><a href="https://posts.specterops.io/attacking-azure-azure-ad-and-introducing-powerzure-ca70b330511a">https://posts.specterops.io/attacking-azure-azure-ad-and-introducing-powerzure-ca70b330511a</a></li><li><a href="https://dirkjanm.io/azure-ad-privilege-escalation-application-admin/">https://dirkjanm.io/azure-ad-privilege-escalation-application-admin/</a></li><li><a href="https://docs.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#general">https://docs.microsoft.com/en-us/azure/role-based-access-control/built-in-roles#general</a></li><li><a href="https://docs.microsoft.com/en-us/graph/permissions-reference#microsoft-graph-permission-names">https://docs.microsoft.com/en-us/graph/permissions-reference#microsoft-graph-permission-names</a></li><li><a href="https://github.com/BloodHoundAD/BloodHound">https://github.com/BloodHoundAD/BloodHound </a></li><li><a href="https://github.com/FSecureLABS/awspx">https://github.com/FSecureLABS/awspx </a></li><li><a href="https://github.com/Azure/Stormspotter">https://github.com/Azure/Stormspotter</a></li></ul></div></div></div><a href="#" class="watch-video-fixed-b w-inline-block w-lightbox"><div class="video-fix-content-div"><img src="https://uploads-ssl.webflow.com/594bb4be5d975d31da8bea55/5fb66748714d8507b6553281_play.svg" loading="lazy" alt="" class="image-11"/><div class="text-block">Watch Summary Video</div></div><script type="application/json" class="w-json">{
  "items": [
    {
      "type": "video",
      "originalUrl": "https://nadavse.wistia.com/medias/n4izm09abp",
      "url": "https://nadavse.wistia.com/medias/n4izm09abp",
      "html": "<iframe class=\"embedly-embed\" src=\"//cdn.embedly.com/widgets/media.html?src=https%3A%2F%2Ffast.wistia.net%2Fembed%2Fiframe%2Fn4izm09abp&display_name=Wistia%2C+Inc.&url=https%3A%2F%2Fnadavse.wistia.com%2Fmedias%2Fn4izm09abp&image=https%3A%2F%2Fembed-ssl.wistia.com%2Fdeliveries%2F3122f50e414476e23b1c263fe98936cfec0804ef.jpg%3Fimage_crop_resized%3D960x540&key=c4e54deccf4d4ec997a64902e9a30300&type=text%2Fhtml&schema=wistia\" width=\"940\" height=\"529\" scrolling=\"no\" title=\"Wistia, Inc. embed\" frameborder=\"0\" allow=\"autoplay; fullscreen\" allowfullscreen=\"true\"></iframe>",
      "thumbnailUrl": "https://embed-ssl.wistia.com/deliveries/3122f50e414476e23b1c263fe98936cfec0804ef.jpg?image_crop_resized=960x540",
      "width": 940,
      "height": 529
    }
  ]
}</script></a><script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=594bb4be5d975d31da8bea55" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script><script src="https://uploads-ssl.webflow.com/594bb4be5d975d31da8bea55/js/webflow.53cc71e6f.js" type="text/javascript"></script><!--[if lte IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/placeholders/3.0.2/placeholders.min.js"></script><![endif]--><script>
$(document).ready(function(){
//menu-dropdown
  var width = $(window).width();
  if (width >= 992) {
    $('.lre').mouseenter(function () {
           $('.lre-dropdown').animate({height: "show"});
         });

     $('.navbar-main').mouseleave(function () {
           $('.lre-dropdown').animate({height: "hide"});
         }); 

    $('.nav-link-rd').not($('.lre')).hover(function () {
           $('.lre-dropdown').animate({height: "hide"});
         });
  }
/*menu-dropdown
  var width = $(window).width();
  if (width >= 992) {
    $('.ser').mouseenter(function () {
           $('.ser-dropdown').animate({height: "show"});
         });

     $('.navbar-main').mouseleave(function () {
           $('.ser-dropdown').animate({height: "hide"});
         }); 

    $('.nav-link-rd').not($('.ser')).hover(function () {
           $('.ser-dropdown').animate({height: "hide"});
         });
  }
  */
});
</script>
<!-- Start of HubSpot Embed Code -->
<script type="text/javascript" id="hs-script-loader" async defer src="//js.hs-scripts.com/8776530.js"></script>
<!-- End of HubSpot Embed Code --></body></html>
