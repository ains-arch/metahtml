<!DOCTYPE html><html lang="en" class="no-transition promotion-enabled" translate="no"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="X-UA-Compatible" content="ie=edge"><meta property="og:locale" content="en_US"><meta property="og:title" content="Payment skimmers have impersonated Sansec &ndash; Sansec"><meta name="author" content="Sansec Team"><meta property="og:url" content="https://sansec.io/research/magecart-hackers-target-sanguine"><meta property="og:site_name" content="Sansec"><meta property="og:image" content="https://sansec.io/assets/posts/purse-handbag.jpg"><meta property="og:type" content="article"><meta property="article:published_time" content="2019-12-02T00:00:00+01:00"><meta property="article:author" content="https://www.twitter.com/sansecio"><meta name="description" content="Some hackers have used a âSansec-themedâ domain name to hack high profile stores around Black Friday.
"><meta property="og:description" content="Some hackers have used a âSansec-themedâ domain name to hack high profile stores around Black Friday.
"><meta name="twitter:title" content="Payment skimmers have impersonated Sansec"><meta name="twitter:image" content="https://sansec.io/assets/posts/purse-handbag.jpg"><meta name="twitter:description" content="Some hackers have used a âSansec-themedâ domain name to hack high profile stores around Black Friday.
"><meta name="twitter:site" content="@sansecio"><meta name="twitter:card" content=" summary_large_image"><link rel="icon" href="/assets/images/favicon.ico" type="image/x-icon"><link rel="stylesheet" href="/assets/css/main.css?0b8b44a"><link rel="canonical" href="https://sansec.io/research/magecart-hackers-target-sanguine"><link type="text/plain" rel="author" href="/humans.txt"><link rel="alternate" type="application/atom+xml" title="Sansec &ndash; Secure stores, happy shoppers" href="/atom.xml"><script>!function(e,t,a,n){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var g=t.getElementsByTagName(a)[0],m=t.createElement(a);m.async=!0,m.src="https://www.googletagmanager.com/gtm.js?id=GTM-W4VK6TQ",g.parentNode.insertBefore(m,g)}(window,document,"script","dataLayer")</script><script type="text/javascript">window._mfq=window._mfq||[],function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="//cdn.mouseflow.com/projects/b8b33745-29ba-4a8d-8a21-4019ba29e934.js",document.getElementsByTagName("head")[0].appendChild(e)}()</script><title>Payment skimmers have impersonated Sansec &ndash; Sansec</title><script type="application/ld+json">{
      "@context": "https://schema.org",
      "@type": "Organization",
      "url": "https://sansec.io",
      "logo": "https://sansec.io/assets/posts/sansec-1107x208.png"
    }</script><script>var Sansec={menu:[{name:"Product",link:"/ecomscan"},{name:"Pricing",link:"/pricing"},{name:"Resources",sub:[{name:"News",link:"/news"},{name:"Research",link:"/research"},{name:"Partners",link:"/partners"},{name:"Support",link:"/support"}]},{type:"spacer"},{name:"Company",link:"/company"},{name:"Contact",link:"/contact"}]}</script><script type="application/ld+json">{
    "description": "Some hackers have used a âSansec-themedâ domain name to hack high profile stores around Black Friday.
",
    "author": { "@type": "Person", "name": "Sansec Team" },
    "@type": "BlogPosting",
    "url": "canon_url",
    "image": "/assets/posts/purse-handbag.jpg",
    "headline": "Payment skimmers have impersonated Sansec",
    "dateModified": "2021-04-22T12:50:26+02:00",
    "datePublished": "2019-12-02T00:00:00+01:00",
    "mainEntityOfPage": {
      "@type": "WebPage",
      "@id": "https://sansec.io/research/magecart-hackers-target-sanguine"
    },
    "@context": "https://schema.org"
  }</script></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W4VK6TQ" height="0" width="0" style="display: none; visibility: hidden;"></iframe></noscript><div class="app"><header><div class="header__promotion__container"><div class="header__promotion__block-wrapper"><div class="header__promotion__block text_bold"><div><a class="link-like_white text_boldest" href="/ecomscan">eComscan</a> secures over 7,000 online stores</div><a class="header__promotion__link" href="/pricing"><ul class="header__promotion__list"><li>30-day money back guarantee</li><li>Easy 5 minute install</li><li>Cancel any time</li></ul></a></div></div></div><div class="header__block__container header__company-logo__container"><a class="company-logo" href="/"><div class="company-logo__img resource resource-logo"></div></a></div><div id="mobile-menu" class="mobile-menu"><div class="col col_mobile-menu"><div class="row mobile-menu__header"><a class="company-logo" href="/"><div class="company-logo__img resource resource-logo"></div></a><div id="mobile-menu__action" class="mobile-menu__action resource has-tap-area"></div></div><ul id="mobile-menu__current-menu" class="col mobile-menu__current-menu"></ul><div class="col mobile-menu__help-block"><a href="/getting-started"><span class="help-text text_underlined no-whitespace">Get started in 5 minutes!</span></a></div></div></div><div class="header__block__container header__navigation__container"><div class="header__navigation__wrapper"><nav><ul class="header__navigation-menu"><li><a class="navigation-menu__link" href="/ecomscan">Product</a></li><li><a class="navigation-menu__link" href="/pricing">Pricing</a></li><li><span id="resources" class="navigation-menu__option has-hover">Resources</span><div class="navigation-menu__submenu-container"><ul class="navigation-menu__submenu" data-menu-for="resources"><li><a href="/news" class="navigation-menu__link">News</a></li><li><a href="/research" class="navigation-menu__link">Research</a></li><li><a href="/partners" class="navigation-menu__link">Partners</a></li><li><a href="/support" class="navigation-menu__link">Support</a></li></ul></div></li><li class="navigation-menu__spacer"></li><li><a class="navigation-menu__link" href="/company">Company</a></li><li><a class="navigation-menu__link" href="/contact">Contact</a></li></ul></nav></div></div><div id="menu" class="has-tap-area"><svg class="hamburger" viewBox="0 0 24 18" xmlns="http://www.w3.org/2000/svg"><g stroke="#1d2227" stroke-width="2"><path d="m0 1h24"></path><path d="m0 9h24"></path><path d="m0 17h24"></path></g></svg></div><div class="header__block__container header__help__container visible-sm"><div class="header__help"><div class="help-cell help-cell-1"><span class="help-text help-text text_underlined no-whitespace">Get started in 5 minutes!</span></div><div class="help-cell help-cell-2"><a href="/getting-started#pricing" class="help-text">Secure your store today.<br><span class="help-text text_underlined">CLICK HERE</span></a></div></div></div></header><main><section class="hero_simple with-centered-circle centered-circle_small centered-circle-bottom-left_offset"><div class="col container-sm top-xs"><div class="hero__contents hero__contents-simple"><h1>Payment skimmers have impersonated Sansec</h1></div></div></section><section class="wrapper_sm is-pushed-xs"><div class="col sticky-container"><article class="article"><ul class="article__meta wrapper_sm container-sm"><li class="meta-block meta-block_left"><div class="meta-block__container"><div class="meta-block-breadcrumbs"><p class="meta__date">2nd December 2019</p><a href="/research">Web Skimming</a> / Sansec Threat Research Team</div><div class="article-block has-shadow_slight visible-xxl sticky" data-aos="fade-right" data-aos-offset="50"><h6>Notifications on eCommerce hacks?</h6><p>Leave you email below and receive notifications on new hacks, vulnerabilities and advice on what you can do to protect your webstore.</p><newsletter data-classes="newsletter_article"></newsletter></div></div></li><li class="meta-block_centered"></li><li class="meta-block"><div class="meta-block__container"><div class="article-block has-shadow_slight resource resource-code visible-xxl sticky" data-aos="fade-left"><h5>What is<br>Magecart?</h5><p>Also known as digital skimming, this crime has surged since 2015. Criminals steal card data during online shopping. Who are behind these notorious hacks, how does it work, and how have Magecart attacks evolved over time?</p><a class="button" href="/what-is-magecart">About Magecart</a></div></div></li></ul><div class="article__contents container-sm"><div class="article__image article__headline-image"><img src="/assets/posts/purse-handbag.jpg" alt="Payment skimmers have impersonated Sansec"></div><div class="article__content"><p>Payment skimmers are hiding their malpractice by impersonating our Sansec anti-skimming service. They have registered malicious domains <strong>sansec.us</strong> and <strong>sanguinelab.net</strong>, even using a fake address in Amsterdam to make it look legitimate. Here is the fraud registration record:</p><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Domain Name: sansec.us
Creation Date: 2019-10-27T12:04:51Z
Registrant Name: William De Groot
Registrant Organization: Sansec ltd
Registrant Street: Damrak 101
Registrant City: Amsterdam
Registrant State/Province: Noord-Holland
Registrant Postal Code: 1012 LM
Registrant Country: NL
Registrant Phone: +31.0687354774
Registrant Email: <a href="/cdn-cgi/l/email-protection" class="__cf_email__" data-cfemail="661507081503050f09261614091209080b070f0a4805090b">[email&#160;protected]</a>
Name Server: ns1.reg.ru
Name Server: ns2.reg.ru
</code></pre></div></div><p><strong>For the sake of clarity: our own domain name is sansec.io, nothing else.</strong></p><p>As you can see, their infrastructure is in Russia, which <em>slightly</em> gives it away. Their payment skimmer is loaded as âprotectionâ such as this:</p><p></p><div class="article__image"><img class="lazy" data-src="/assets/posts/cache/723e3f39b575deef8a91c4ee828f3b31.png" alt=""></div><p></p><h2 id="advanced-anti-reverse-engineering">Advanced anti reverse engineering</h2><p>These fake âSansecâ skimmers have been injected on a number of high profile stores, harvesting the peak of transactions at Black Friday. Not all malware uses a âSansec-themedâ domain name, but all of the big ones share identical code and infrastructure.</p><p>A notable example is stock-listed Smith &amp; Wesson (<a href="https://finance.yahoo.com/quote/AOBC">NYSE</a>). The gun giant caught a skimmer on Wed Nov 27, just in time for Black Friday, and is present at the time of writing. <strong>Update Dec 3rd: the skimmer has been removed from the Smith &amp; Wesson store</strong></p><p></p><div class="article__image"><img class="lazy" data-src="/assets/posts/cache/92c66fd363b7db90de8df226adcaff83.png" alt=""></div><p></p><p>This skimmer is exceptionally sophisticated, as it features:</p><ul><li>Multiple anti reverse engineering methods such as devtools, Amazon AWS, country &amp; Linux detection.</li><li>A 3-stage loader</li><li>4 layers of Javascript obfuscation</li></ul><p>The loader at <code class="highlighter-rouge">live.sequracdn.net/storage/modrrnize.js</code> serves some innocent code, until you start the actual payment process. It only works for US-based IPs, using non-Linux browsers, and not using the AWS platform. Here, you can see the file size changing from 11 to 20 KB upon entering the checkout section:</p><p></p><div class="article__image"><img class="lazy" data-src="/assets/posts/cache/10377cba958fd0f7653012b551627dae.png" alt=""></div><p></p><p>The code has multiple levels of obfuscation, each rendering a new anonymous function to complicate debugging.</p><p></p><div class="article__image"><img class="lazy" data-src="/assets/posts/cache/72d16779cee7aa7bf36d82585c216bd1.png" alt=""></div><p></p><p>At stage 3, a fake payment form is constructed. Then another file is loaded from <code class="highlighter-rouge">https://live.sequracdn.net/storage/mk.js</code> which contains the actual exfiltration code.</p><p></p><div class="article__image"><img class="lazy" data-src="/assets/posts/cache/7932540607bbe0ea45d4db956acd1e4c.png" alt=""></div><p></p><p>Finally, the payments are intercepted and sent to <code class="highlighter-rouge">https://live.sequracdn.net/t/</code></p><p></p><div class="article__image"><img class="lazy" data-src="/assets/posts/cache/edd26a89c3f7c5678e0f1639426cdbca.png" alt=""></div><p></p><p>Acknowledgement: <a href="https://twitter.com/AffableKraut">@AffableKraut</a> contributed to this investigation.</p></div></div></article></div></section><section class="bg_grey"><div class="wrapper_card container-sm pull-me-up-xs"><div class="col action-card has-shadow_slight with-centered-circle centered-circle_small centered-circle-bottom-left centered-circle_yellow" data-aos="fade-up"><div class="col action-card__contents"><h5>Stay ahead of eCommerce hacks,<br>protect your store today!</h5><p>Sansec forensic experts were the first to document large scale digital skimming in 2015. Since then, we have investigated thousands of hacked stores. Our research of the latest attack vectors protects our customers around the world. Our anti-skimming technology and data are used by merchants, forensic investigators, financial anti-fraud teams and service providers</p><a class="button action-card__button" href="/ecomscan">Try our malware scanner</a></div></div></div></section></main><footer class="with-centered-circle centered-circle_bottom-to-right centered-circle_yellow"><script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script type="text/javascript">!function(e,t,s,i){e.visitorGlobalObjectAlias="vgo",e[e.visitorGlobalObjectAlias]=e[e.visitorGlobalObjectAlias]||function(){(e[e.visitorGlobalObjectAlias].q=e[e.visitorGlobalObjectAlias].q||[]).push(arguments)},e[e.visitorGlobalObjectAlias].l=(new Date).getTime(),(s=t.createElement("script")).src="https://diffuser-cdn.app-us1.com/diffuser/diffuser.js",s.async=!0,(i=t.getElementsByTagName("script")[0]).parentNode.insertBefore(s,i)}(window,document),vgo("setAccount","252938389"),vgo("setTrackByDefault",!0),vgo("process")</script><div class="footer__contents"><div class="footer__top row top-xs space-between-xs"><div class="footer__top__block visible-sm"><span class="footer__top__block__title">Made with <span class="icon_green">â¤</span> in Europe</span><ul class="footer__address"><li>Sansec BV</li><li>Europalaan 20</li><li>3526 KS Utrecht</li><li>The Netherlands</li><li><a href="/cdn-cgi/l/email-protection#f79e999198b7849699849294d99e98"><span class="__cf_email__" data-cfemail="325b5c545d7241535c4157511c5b5d">[email&#160;protected]</span></a></li></ul></div><div class="footer__top__block visible-sm"><ul class="footer__links__list"><li><a href="/ecomscan">Product</a></li><li><a href="/pricing">Pricing</a></li><li><a href="/support">Support</a></li><li><a href="/partners">Partners</a></li><li><a href="/magento-usage-data">Magento Stats</a></li><li><a href="/malware">Malware Library</a></li><li><a href="/research/cardbleed">Cardbleed</a></li></ul></div><div class="footer__top__block visible-sm"><ul class="footer__links__list"><li><a href="/research">Research</a></li><li><a href="/news">News</a></li><li><a href="/company">Company</a></li><li><a href="/contact">Contact</a></li><li><a href="#" data-cb-type="portal" class="footer__login">Log in</a></li></ul></div><div class="footer__top__block"><div class="stay-informed"><div class="stay-informed__title">Stay up to date with the latest eCommerce attacks</div><newsletter data-classes="newsletter_footer"></newsletter></div></div></div><div class="footer__company"><div class="col row-sm middle-xs space-between-sm baseline-sm"><div class="company-logo"><div class="company-logo__img resource resource-logo_white"></div></div><div class="motto">Secure stores, happy shoppers</div></div><div class="footer__separator"></div><div class="col row-sm middle-sm space-between-sm"><div class="footer__social_networks"><a class="resource resource-twitter" href="https://twitter.com/sansecio" target="_blank"></a> <a class="resource resource-linkedin" href="https://www.linkedin.com/company/sansec/" target="_blank"></a> <a class="resource resource-mail" href="/cdn-cgi/l/email-protection#4b22252d240b382a25382e28652224"></a></div><div class="footer__terms"><div class="footer__terms__item"><a class="footer__terms__link has-tap-area tap-area_sm" href="/downloads/sansec_tc.pdf">Terms & Conditions</a><div class="footer__terms__separator">|</div><a class="footer__terms__link has-tap-area tap-area_sm" href="/downloads/sansec_pcp.pdf">Privacy & Cookie Policy</a><div class="footer__terms__separator visible-sm">|</div></div><div class="footer__terms__item"><span>Company Reg 77165187</span><div class="footer__terms__separator">|</div><span>Tax NL860920306B01</span></div></div></div></div></div></footer></div><script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script async src="/assets/js/main.js?0b8b44a"></script><script src="https://js.chargebee.com/v2/chargebee.js" data-cb-site="sansec"></script><script async src="/assets/js/sticky.js?0b8b44a"></script><script async src="/assets/js/newsletter.js?0b8b44a" type="text/javascript" charset="utf-8"></script><script>!function(e,t,n,i,a,c){e.twq||((i=e.twq=function(){i.exe?i.exe.apply(i,arguments):i.queue.push(arguments)}).version="1.1",i.queue=[],(a=t.createElement(n)).async=!0,a.src="//static.ads-twitter.com/uwt.js",(c=t.getElementsByTagName(n)[0]).parentNode.insertBefore(a,c))}(window,document,"script"),twq("init","o54o6"),twq("track","PageView")</script><script type="text/javascript">_linkedin_partner_id="3076097",window._linkedin_data_partner_ids=window._linkedin_data_partner_ids||[],window._linkedin_data_partner_ids.push(_linkedin_partner_id)</script><script type="text/javascript">!function(){var t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src="https://snap.licdn.com/li.lms-analytics/insight.min.js",t.parentNode.insertBefore(e,t)}()</script><noscript><img height="1" width="1" style="display: none;" alt="" src="https://px.ads.linkedin.com/collect/?pid=3076097&fmt=gif"></noscript></body></html>